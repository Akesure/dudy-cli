import React, {Component} from 'react'
import ReactDOM from 'react-dom'

import Screens from "screen"
import {AppContainer} from 'container'

import {
  HashRouter as Router,
  Route,
  Link
} from 'react-router-dom'

import {get_current_path} from 'helper'
import {init_store} from 'store'
import {Provider} from 'react-redux'
import "../global.js"

import RedBox from 'redbox-react'

try{
  const Layout = ({children}) => {
    return <div>
      {children}
    </div>
  }


  class App extends Component{

    constructor(){
      super()
      this.state = { store : null }
    }

    componentWillMount(){

      init_store().then(store => {
        this.setState({
          store

        })
      })
    }

    render() {
      if(!this.state.store) {return null}
      return <Provider store={this.state.store}>
        <Router>
          <Route path='/' >
            <Layout>
              <Route exact path="" component={Screens.__SCREEN_NAME__} />
            </Layout>
          </Route>
        </Router>
      </Provider>

    }
  }


  ReactDOM.render(
    <App />,
    document.getElementById("app"))
}catch(e) {
  ReactDOM.render(
    <Redbox error={e} />,
    document.getElementById("app"))
}
